# CONCEPT 26: Why Secrets Must NOT Be Passed via Command Line
# WHY: Command line arguments appear in process lists and logs.
#      Use environment variables instead for security.

name: 26 - Secrets Command Line Security Demo

on:
  workflow_dispatch:

jobs:
  security-demo:
    runs-on: ubuntu-latest
    steps:
      - name: BAD vs GOOD - Passing secrets
        env:
          MY_SECRET: ${{ secrets.DEMO_API_KEY }}
        run: |
          echo "üîê SECURITY BEST PRACTICES"
          echo ""
          echo "‚ùå BAD - Command line arguments:"
          echo "   ./deploy.sh --api-key=my-secret-key"
          echo "   curl -u user:password https://api.example.com"
          echo ""
          echo "   WHY BAD:"
          echo "   - Visible in 'ps' process list"
          echo "   - May be logged in shell history"
          echo "   - Could appear in error messages"
          echo "   - Other processes can see arguments"
          echo ""
          echo "‚úÖ GOOD - Environment variables:"
          echo "   export API_KEY=\${{ secrets.MY_SECRET }}"
          echo "   ./deploy.sh  (reads API_KEY from env)"
          echo ""
          echo "   WHY GOOD:"
          echo "   - Not visible in process lists"
          echo "   - Not logged in shell history"
          echo "   - Automatically redacted by GitHub"
      
      - name: Demonstration of process visibility
        run: |
          echo "üìã Simulating process list visibility:"
          echo ""
          echo "If you ran: ./script.sh --password=secret123"
          echo "Others could see: ps aux | grep script"
          echo "Output: ./script.sh --password=secret123  ‚Üê EXPOSED!"
          echo ""
          echo "If you ran: PASSWORD=secret123 ./script.sh"
          echo "Others see: ps aux | grep script"
          echo "Output: ./script.sh  ‚Üê Password NOT visible!"

# üìå KEY LESSON: Always use env vars, never command line args
# üìå MCQ TIP: Command line args are visible to all processes
